# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.13479454007, 0.13479454007,0.13479454007,0.137708602354,0.13479454007,0.0569200628744,0.0356148194725,0.0356148194725,0.0356148194725,0.0356148194725,0.0356148194725,0.0356148194725,0.0356148194725,0.0356148194725,0.0406030682402,0.0496491048808,0.0557468928447,0.0661601278512,0.0661601278512,0.069016262985,0.101836689924,0.101836689924,0.101836689924,0.101836689924,0.101836689924,0.101836689924,0.101836689924,0.0878957383247,0.0956124051981,0.0617121309198,0.083895744368,0.121570856598,0.138364113535,0.1768677124,0.1768677124,0.187524072933,0.187524072933,0.187524072933,0.1768677124,0.1768677124,0.187524072933,0.132664869801,0.113695598018,0.0889828281155,0.0729666627437,0.0729666627437,0.0729666627437,0.0729666627437,0.0729666627437,0.0682418032073,0.0682418032073,0.0682418032073,0.0682418032073)
L_hpd_M95=c(0.343307263378, 0.343307263378,0.343307263378,0.343307263378,0.343307263378,0.34722746587,0.187524072933,0.1446871111,0.1446871111,0.1446871111,0.1446871111,0.1446871111,0.1446871111,0.1446871111,0.151395308724,0.161954649696,0.165581330663,0.16997464916,0.168488530813,0.174315503097,0.191512140366,0.189311740559,0.189311740559,0.189311740559,0.190891966836,0.190891966836,0.194428582602,0.194428582602,0.203893856197,0.214583958363,0.390440778361,0.442760294882,0.454168428646,0.48816505577,0.48816505577,0.495414175285,0.495414175285,0.495414175285,0.48816505577,0.48816505577,0.48816505577,0.483854160625,0.509445713446,0.503893071661,0.495414175285,0.488653775914,0.496466400066,0.488653775914,0.488653775914,0.488653775914,0.488653775914,0.488653775914,0.488653775914)
M_hpd_m95=c(0.866088273898, 0.866088273898,0.0872979333522,0.0872979333522,0.0872979333522,0.0920002973284,0.0920002973284,0.0920002973284,0.0920002973284,0.0920002973284,0.0920002973284,0.0864067742183,0.0891795613964,0.0891795613964,0.0891795613964,0.0891795613964,0.0891795613964,0.0891795613964,0.0891795613964,0.085607219138,0.085607219138,0.084782115674,0.0793959584928,0.0779950897538,0.0757208117645,0.0720029860897,0.0664770391822,0.0606358008757,0.0594573322081,0.0470257418219,0.0470257418219,0.0479424106558,0.0470257418219,0.0414765769461,0.0275562518732,0.0275562518732,0.0307145788295,0.0307145788295,0.0307145788295,0.0307145788295,0.0307145788295,0.0307145788295,0.0307145788295,0.0307145788295,0.0307145788295,0.0307145788295,0.0307145788295,0.0307145788295,0.0307145788295,0.0307145788295,0.0307145788295,0.0307145788295,0.0307145788295)
M_hpd_M95=c(1.55496014496, 1.55496014496,0.158038517308,0.158038517308,0.158038517308,0.158038517308,0.158038517308,0.158038517308,0.158038517308,0.158038517308,0.158038517308,0.146853709395,0.141697615715,0.141697615715,0.141697615715,0.141697615715,0.141697615715,0.141697615715,0.141697615715,0.139677545875,0.139677545875,0.139677545875,0.141697615715,0.141697615715,0.141697615715,0.139460853968,0.139460853968,0.139460853968,0.140149489943,0.126591743785,0.127949856714,0.126856013991,0.126856013991,0.127949856714,0.150867340266,0.150867340266,0.156213132045,0.156213132045,0.157220732079,0.157220732079,0.157220732079,0.157220732079,0.157220732079,0.157220732079,0.157220732079,0.157220732079,0.157220732079,0.157220732079,0.157220732079,0.157220732079,0.157220732079,0.157220732079,0.157220732079)
R_hpd_m95=c(-1.24477385276, -1.24477385276,0.0179931355113,0.0179931355113,0.0179931355113,-0.0800666256663,-0.106628010252,-0.106628010252,-0.106628010252,-0.106628010252,-0.106628010252,-0.0817143551035,-0.0817143551035,-0.0817143551035,-0.0767498766534,-0.071801841462,-0.0601740599133,-0.0601740599133,-0.0549854796544,-0.0441545535469,-0.0327412969679,-0.02861403694,-0.00849593167104,-0.00491957426488,-0.00958577975385,-0.00849593167104,-0.0120084743484,-0.0302621357304,-0.0120232479022,-0.0489802006403,-0.00849593167104,0.0193386183419,0.0600592834581,0.0600592834581,0.0600592834581,0.0600592834581,0.0600592834581,0.0600592834581,0.0574943752988,0.0574943752988,0.0574943752988,0.057274229567,0.0181994989416,-0.00890311886422,-0.0135132422008,-0.0382294103934,-0.0183366579628,-0.0382294103934,-0.0382294103934,-0.0382294103934,-0.0382294103934,-0.0382294103934,-0.0382294103934)
R_hpd_M95=c(-0.530984712428, -0.530984712428,0.235725434765,0.228279951959,0.235725434765,0.212818165959,0.086645841656,0.0336101946152,0.031392087753,0.031392087753,0.0336101946152,0.0458043277851,0.0377217389106,0.0377217389106,0.0409738778688,0.0488711074913,0.0561028346103,0.066275068006,0.066275068006,0.0747372605312,0.0747372605312,0.0747372605312,0.0834202755733,0.0779188099787,0.0747372605312,0.0834202755733,0.0941547909321,0.104893598362,0.1256564997,0.132329656402,0.300039125374,0.363265816858,0.394694032228,0.394694032228,0.394694032228,0.394694032228,0.394694032228,0.394694032228,0.394694032228,0.394694032228,0.394694032228,0.409210766094,0.425963207603,0.409210766094,0.425963207603,0.397076424075,0.425963207603,0.397076424075,0.397076424075,0.397076424075,0.397076424075,0.397076424075,0.397076424075)
L_mean=c(0.269527945664, 0.269527945664,0.269527945664,0.268718378374,0.267803564779,0.226636424928,0.0933990559223,0.0860535539565,0.0860535539565,0.0860535539565,0.0860535539565,0.0860535539565,0.0860535539565,0.0861708523867,0.0885262553474,0.101182070737,0.112181055152,0.121439909999,0.127323752923,0.136661239133,0.141588166327,0.142866593327,0.143319873317,0.14331772406,0.143340330725,0.143340330725,0.1421814433,0.140831556758,0.141149496514,0.147056732577,0.212757133994,0.31057197423,0.321384937052,0.323148335097,0.3227866557,0.323268974965,0.323695023411,0.323695023411,0.322656442469,0.321493813112,0.322046522702,0.317323432311,0.311312856984,0.296137463742,0.289881206505,0.285943965093,0.286800128907,0.286037670066,0.286952784491,0.285127596513,0.285127596513,0.285127596513,0.285127596513)
M_mean=c(1.16904517639, 1.16904517639,0.12531133743,0.12531133743,0.12531133743,0.123635145703,0.123635145703,0.123483714384,0.122704637311,0.122557689972,0.121713190503,0.11739179245,0.11448266477,0.11448266477,0.11448266477,0.11448266477,0.11448266477,0.11448266477,0.11448266477,0.114332831732,0.114332831732,0.114255762959,0.111227516919,0.109736158328,0.109442141438,0.107472065418,0.104733473924,0.100817969423,0.0984963777598,0.0945917571767,0.0920901214875,0.0897155774283,0.0892321417828,0.0905879945707,0.0890225322139,0.0876520922318,0.0882389774243,0.0882389774243,0.0888316712871,0.0889180301638,0.0892106482373,0.0892106482373,0.0892106482373,0.0892106482373,0.0892106482373,0.0892106482373,0.0892106482373,0.0892106482373,0.0892106482373,0.0892106482373,0.0892106482373,0.0892106482373,0.0892106482373)
R_mean=c(-0.899517230724, -0.899517230724,0.144216608234,0.143407040944,0.142492227349,0.103001279225,-0.0302360897809,-0.0374301604275,-0.0366510833549,-0.036504136015,-0.0356596365462,-0.0313382384938,-0.0284291108132,-0.028311812383,-0.0259564094223,-0.0133005940323,-0.00230160961753,0.00695724522899,0.0128410881532,0.022328407401,0.027255334595,0.0286108303671,0.0320923563983,0.033581565732,0.0338981892874,0.0358682653078,0.0374479693756,0.0400135873344,0.0426531187542,0.0524649754002,0.120667012507,0.220856396802,0.232152795269,0.232560340527,0.233764123486,0.235616882734,0.235456045987,0.235456045987,0.233824771182,0.232575782948,0.232835874465,0.228112784074,0.222102208747,0.206926815504,0.200670558267,0.196733316856,0.197589480669,0.196827021828,0.197742136253,0.195916948276,0.195916948276,0.195916948276,0.195916948276)
trans=0.5
age=(0:(53-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.560390284791), xlim = c(-55.65,2.65), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.71045615946), xlim = c(-55.65,2.65), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.36925123803, 0.468559528363), xlim = c(-55.65,2.65), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-55.65,2.65), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()