# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.146769460933, 0.146769460933,0.155724024837,0.146769460933,0.137946331839,0.0638562554498,0.0466054243013,0.0475296384042,0.04674101232,0.0474110959531,0.0485985195557,0.0498237901764,0.0498237901764,0.049529372376,0.0498237901764,0.0509551997122,0.0506644704595,0.0537131393678,0.0547164190507,0.0604314030911,0.065166457346,0.0659621643423,0.0747171109805,0.0862275447116,0.093878759568,0.0944281579223,0.0942519678164,0.0942519678164,0.0961826086991,0.0932050032395,0.107856815512,0.116703327774,0.121897595214,0.121849680112,0.13519853729,0.1379595487,0.121897595214,0.122788530941,0.122152145201,0.118960224406,0.121897595214,0.121897595214,0.118222415019,0.118222415019,0.117195692363,0.108311844881,0.101798462284,0.0978998762757,0.100019501267,0.100019501267,0.100019501267,0.100019501267)
L_hpd_M95=c(0.349642684429, 0.349642684429,0.35876961802,0.350648387294,0.349949200897,0.331719002569,0.223883645295,0.138341527189,0.131205621896,0.130816042976,0.131998458966,0.131998458966,0.131998458966,0.131998458966,0.131998458966,0.138341527189,0.142056508094,0.150150713157,0.162787092892,0.181064105999,0.188922413355,0.19738937836,0.212350400197,0.22318676493,0.227304720702,0.227304720702,0.227304720702,0.230692429531,0.244320393308,0.271068021057,0.3129024725,0.331377860214,0.349326727284,0.35371503324,0.376543108681,0.379436897572,0.367406837696,0.368486590139,0.368486590139,0.368486590139,0.375508467908,0.379424559912,0.382420750933,0.388512873638,0.394455590399,0.393502519631,0.393401673379,0.396911271959,0.396911271959,0.401554154248,0.4024958189,0.4024958189)
M_hpd_m95=c(0.88468916393, 0.88468916393,0.0855308493684,0.085581340577,0.0858102265159,0.0855308493684,0.085581340577,0.0855308493684,0.0858102265159,0.0855308493684,0.0858102265159,0.0859694003775,0.086142208468,0.0860054303795,0.0859694003775,0.0858102265159,0.0855308493684,0.0835693058381,0.0855308493684,0.0855308493684,0.0835693058381,0.0842388380316,0.0661728140883,0.0562816892925,0.0542155008908,0.0527894705219,0.051892843656,0.051892843656,0.052599409261,0.052599409261,0.052599409261,0.052599409261,0.052599409261,0.051892843656,0.051892843656,0.0524628302878,0.0524628302878,0.0519280987924,0.051892843656,0.051892843656,0.0520961857366,0.051892843656,0.0515883104686,0.0504514767658,0.0492081719698,0.0476013482153,0.0476013482153,0.0476013482153,0.0476013482153,0.0476013482153,0.0476013482153,0.0476013482153)
M_hpd_M95=c(1.5033499517, 1.5033499517,0.146165761709,0.146165761709,0.146165761709,0.144461400322,0.143834888074,0.142825102659,0.141060999868,0.137809142131,0.137184631569,0.137014431739,0.137014431739,0.137014431739,0.137014431739,0.136982902052,0.136782914918,0.134884523747,0.136782914918,0.136782914918,0.134833466729,0.137014431739,0.132990845122,0.12582102212,0.12337126237,0.12337126237,0.122413401337,0.122413401337,0.12337126237,0.12337126237,0.12337126237,0.12337126237,0.12337126237,0.122892264281,0.122892264281,0.12337126237,0.12337126237,0.123046960574,0.123046960574,0.123046960574,0.12337126237,0.12337126237,0.12337126237,0.12337126237,0.12337126237,0.124593537492,0.124806377706,0.124806377706,0.124806377706,0.124806377706,0.124806377706,0.124806377706)
R_hpd_m95=c(-1.25695847946, -1.25695847946,0.0387618962832,0.0388514968248,0.0268421738271,-0.0582729467834,-0.090735585394,-0.0809208061022,-0.0787098236924,-0.0722774782877,-0.0716234802124,-0.0715806066167,-0.0687795870067,-0.0675890787789,-0.0673454797437,-0.0677794041084,-0.0657113780447,-0.0651486379523,-0.0630679569546,-0.0546350201676,-0.0513793021195,-0.0462695136691,-0.0338304969896,-0.0168962104388,-0.0110652803896,-0.0072141891338,-0.0067202722501,-0.00661793791977,-0.00661793791977,-0.00262535977918,0.00660729534332,0.0222476592785,0.0240965661138,0.0244728396261,0.0317252262176,0.0317252262176,0.0293484573676,0.0293484573676,0.0292681285531,0.0248336061682,0.0248336061682,0.0262405241922,0.0182322499742,0.00773658735577,0.00322350708076,-0.00639736496495,-0.00407615129675,0.00322350708076,0.00350865996443,0.00322350708076,0.00322350708076,0.00322350708076)
R_hpd_M95=c(-0.608847563955, -0.608847563955,0.243707921217,0.244730672863,0.242778463476,0.222545491499,0.121356281882,0.0330173663291,0.0283605132678,0.0305721028426,0.0297042616763,0.0280366250139,0.0305721028426,0.0319783275001,0.0319783275001,0.0350024908118,0.0403245102229,0.0453121639937,0.0603820122718,0.0770955282511,0.0850924322887,0.097390696703,0.117022725342,0.136739042422,0.139522229109,0.145564608641,0.145105767789,0.14678008159,0.158377966573,0.185770852942,0.224632766234,0.250768185067,0.267300984928,0.275577028397,0.285768325607,0.286212183494,0.28800506386,0.28800506386,0.289393122076,0.287329064599,0.291442294941,0.29778966014,0.297608186346,0.29778966014,0.30443898365,0.309192497633,0.320959182136,0.335766930306,0.337035394445,0.339154642688,0.34002348255,0.34002348255)
L_mean=c(0.261909091382, 0.261909091382,0.262125231032,0.262102999713,0.260427858298,0.22047573196,0.0956177352818,0.0862589397881,0.0849884322951,0.0845780005908,0.0845827869269,0.0843313336611,0.0843939373786,0.0846248490232,0.08559670814,0.0878684741805,0.0902054737342,0.0932354049495,0.099898577254,0.113113831089,0.120942641579,0.132678890461,0.147866191583,0.157858054879,0.161137570794,0.162378079547,0.162779938778,0.163955005612,0.1689836368,0.181891847908,0.199667164021,0.211562549315,0.222085058921,0.23061304252,0.236527538943,0.237112924311,0.237166897497,0.236268449691,0.236451730501,0.236489279952,0.236809586152,0.237899248716,0.238262164285,0.23949500478,0.241811360174,0.243531346046,0.246322944135,0.247531798497,0.24723263335,0.24785551517,0.247747489144,0.247782105453)
M_mean=c(1.17352811708, 1.17352811708,0.1127344119,0.112703686621,0.112640531663,0.112356937747,0.112227516495,0.111883068977,0.111424214795,0.110563391122,0.110314802584,0.109984563267,0.109722527444,0.109633641546,0.109386643372,0.108970558556,0.108550197001,0.108376550779,0.108335675563,0.108335840025,0.108324752068,0.108013202166,0.103831200414,0.0978189314954,0.095002152772,0.093785772875,0.093190349873,0.0930749977702,0.0930066948026,0.0929908704857,0.0929908704857,0.0930110582387,0.0930110582387,0.0930466808681,0.0929897699309,0.0929049808519,0.0928929432806,0.0928864292645,0.0928608773447,0.0928608773447,0.0929315007446,0.0930375876218,0.093215887772,0.0940175399121,0.0949167603188,0.0959427990377,0.0960457659285,0.0960457659285,0.0960457659285,0.0960457659285,0.0960457659285,0.0960457659285)
R_mean=c(-0.911619025694, -0.911619025694,0.149390819132,0.149399313093,0.147787326635,0.108118794213,-0.0166097812128,-0.0256241291891,-0.0264357824996,-0.0259853905314,-0.0257320156567,-0.0256532296062,-0.025328590065,-0.0250087925228,-0.0237899352315,-0.0211020843758,-0.0183447232672,-0.0151411458292,-0.00843709830906,0.00477799106432,0.012617889511,0.0246656882954,0.0440349911693,0.0600391233834,0.0661354180221,0.0685923066723,0.0695895889048,0.0708800078422,0.0759769419978,0.0889009774225,0.106676293535,0.118551491076,0.129074000682,0.137566361652,0.143537769012,0.144207943459,0.144273954217,0.143382020427,0.143590853157,0.143628402607,0.143878085408,0.144861661094,0.145046276513,0.145477464868,0.146894599855,0.147588547008,0.150277178207,0.151486032568,0.151186867421,0.151809749242,0.151701723216,0.151736339525)
trans=0.5
age=(0:(52-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.44274540079), xlim = c(-54.6,2.6), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.65368494687), xlim = c(-54.6,2.6), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.38265432741, 0.374025830805), xlim = c(-54.6,2.6), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-54.6,2.6), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()